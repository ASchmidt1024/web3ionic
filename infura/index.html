<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Infura Ethereum Explorer</title>
  <script src="web3.min.js"></script>
  <script>

    // new web3
    web3 = new Web3(new Web3.providers.HttpProvider("https://mainnet.infura.io/1GQbVif1gU8ny72LoUSc"));
    console.log('web3:', web3);

    // get latest block
    web3.eth.getBlockNumber().then(value => {
      console.log('block number 1', value);
      document.getElementById("blockNumberOutput").innerHTML = value;
    });

    // get balance
    function printAccountBalance() {
      var GET = {};
      var query = window.location.search.substring(1).split("&");
      for (var i = 0, max = query.length; i < max; i++)
      {
        if (query[i] === "")
          continue;
        var param = query[i].split("=");
        GET[decodeURIComponent(param[0])] = decodeURIComponent(param[1] || "");
      }
      var account = GET.account;

      web3.eth.getBalance(account).then(value => {
        var balance = web3.utils.fromWei(value, 'ether');
        document.getElementById("balanceOutput").innerHTML = balance + " ETH <br>";
      });
    }

    // send transaction
    let addressFrom = '0x00d1B89E8Cc489aB76d46F1F9Ea743A9d4eFf516';
    let addressTo = '0x004ab631B3D694A03731288F9Da6Ebdfe4ad4D01';
    let addressCom = '0x008855576e56f1d1aA22D5def1bc675450636F58';
    let totalValue = web3.utils.toWei('0.000001', 'ether');
    console.log('value', totalValue);

    setTimeout(function() {
      document.getElementById("addressFromOutput").innerHTML = addressFrom;
      document.getElementById("addressToOutput").innerHTML = addressTo;
      document.getElementById("addressComOutput").innerHTML = addressCom;
      document.getElementById("totalValueOutput").innerHTML = totalValue;
    }, 1000);

    function sendTransaction() {
      console.log('send transaction:');
      web3.eth.sendTransaction({
          from: addressFrom,
          to: addressTo,
          value: totalValue
      })
      .then((receipt) => {
          console.log('receipt', receipt);
      })
      .catch((error) => {
        console.log(error);
      });
    }

    // create wallet
    web3.eth.accounts.wallet.create(2, '23456321§3456764321§345674321§3123457544±-±§±-±!!!43531234534534');
    console.log('wallet: ', web3.eth.accounts.wallet);
    console.log('accounts: ', web3.eth.accounts);


  </script>
</head>
<body>
  <h1>Infura Ethereum Explorer</h1>
  <form action="index.html" method="GET">
    <p>
      <label>Enter an account:</label>
      <input type="text" size="50" name="account">
    </p>
    <p>
      <input type="submit" value="get balance">
    </p>
  </form>
  <p>
    Latest Block: <span id="blockNumberOutput"></span>
  </p>
  <p>
    Account Balance: <span id="balanceOutput"></span>
    <script>printAccountBalance();</script>
  </p>
  <h2>Send Transaction</h2>
  <p>From: <span id="addressFromOutput"></span></p>
  <p>To: <span id="addressToOutput"></span></p>
  <p>Com: <span id="addressComOutput"></span></p>
  <p>Value: <span id="totalValueOutput"></span></p>
  <p>
    <input type="submit" value="send transaction" onclick="sendTransaction()">
  </p>
</body>
</html>

